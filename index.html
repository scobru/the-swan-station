<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>THE SWAN</title>
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="src/style.css" />

  <!-- Fallback CSS in case external stylesheet fails to load -->
  <style>
    /* Critical fallback styles */
    body {
      font-family: 'VT323', monospace;
      background-color: #000;
      color: #00ff00;
      margin: 0;
      padding: 20px;
    }

    .log-container {
      font-family: 'VT323', monospace;
      background-color: #000;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 10px;
      margin: 10px 0;
      max-height: 400px;
      overflow-y: auto;
    }

    .input {
      font-family: 'VT323', monospace;
      background-color: #000;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 5px;
    }

    .big-timer {
      font-family: 'VT323', monospace;
      font-size: 48px;
      color: #00ff00;
      text-align: center;
      margin: 20px 0;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
    }

    .prompt {
      position: fixed;
      top: 100px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      color: #00ff00;
    }
  </style>

  <!-- Prevent iOS tap highlight -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <!-- Add iOS icons and splash screens here if needed -->
</head>

<body>
  <div id="statsContainer" class="stats-container"></div>

  <!-- Logo and Station Rules -->
  <div class="header-section">
    <div class="logo-container">
      <img src="assets/swan.png" alt="SHOGUN ECO Swan Station" class="station-logo">
      <div class="logo-text">SHOGUN ECO</div>
      <div class="station-name">SWAN STATION</div>
      <div class="connection-status" id="connectionStatus">CONNECTING...</div>
      <div class="contribution-indicator" id="contributionIndicator">CONTRIBUTING TO NETWORK</div>
    </div>
    <div class="rules-toggle">
      <button id="aboutBtn" class="rules-button">[ ABOUT ]</button>
      <button id="rulesBtn" class="rules-button">[ STATION RULES ]</button>
      <button id="menuToggleBtn" class="rules-button">[ TIMER ]</button>
    </div>
  </div>

  <!-- Timer and Input (always visible when menu is OFF) -->
  <div id="bigTimer" class="big-timer">108</div>
  <div class="prompt">
    >: <input type="text" class="input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  </div>

  <div class="container">
    <h1><span>&gt;</span>:</h1>
  </div>

  <div class="log-container" id="logContainer"></div>
  <!-- Shogun Core CDN -->
  <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@multiavatar/multiavatar/multiavatar.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/shogun-core@^1.10.3/dist/browser/shogun-core.js"></script>

  <!-- Timer Module -->
  <script src="src/modules/timer.js"></script>

  <script>
    // Check if CSS is loaded properly
    window.addEventListener('load', function () {
      const styles = document.styleSheets;
      let cssLoaded = false;

      for (let i = 0; i < styles.length; i++) {
        try {
          if (styles[i].href && styles[i].href.includes('style.css')) {
            cssLoaded = true;
            break;
          }
        } catch (e) {
          // CORS error, but CSS might still be loaded
          cssLoaded = true;
        }
      }

      if (!cssLoaded) {
        console.warn('External CSS not loaded, using fallback styles');
        // Add additional fallback styles if needed
        const fallback = document.createElement('style');
        fallback.textContent = `
          .stats-container { font-family: 'VT323', monospace; color: #00ff00; }
          .header-section { font-family: 'VT323', monospace; color: #00ff00; }
          .container { font-family: 'VT323', monospace; color: #00ff00; }
          .prompt { font-family: 'VT323', monospace; color: #00ff00; }
        `;
        document.head.appendChild(fallback);
      }
    });
  </script>
  <script src="src/script.js"></script>
</body>

</html>